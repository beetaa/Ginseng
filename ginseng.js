function getPreciseIntervalStr(t){var e=moment.duration(t);return e.asMinutes()<=1?"<1 min":e.asYears()>=1?Math.round(10*e.asYears())/10+" years":e.asMonths()>=1?Math.round(10*e.asMonths())/10+" months":e.asWeeks()>=1?Math.round(10*e.asWeeks())/10+" weeks":e.asDays()>=1?Math.round(10*e.asDays())/10+" days":e.asHours()>=1?Math.round(10*e.asHours())/10+" hours":e.asMinutes()>=1?Math.round(10*e.asMinutes())/10+" minutes":void 0}function getShortPreciseIntervalStr(t){var e=moment.duration(t);return e.asMinutes()<=1?"<1 min":e.asYears()>=1?Math.round(10*e.asYears())/10+" y":e.asMonths()>=1?Math.round(10*e.asMonths())/10+" m":e.asWeeks()>=1?Math.round(10*e.asWeeks())/10+" w":e.asDays()>=1?Math.round(10*e.asDays())/10+" d":e.asHours()>=1?Math.round(10*e.asHours())/10+" h":e.asMinutes()>=1?Math.round(10*e.asMinutes())/10+" m":void 0}var InfoBrowser=React.createClass({displayName:"InfoBrowser",getInitialState:function(){return{filterText:"",sortOrder:"1"}},onFilterChange:function(e){this.setState({filterText:e.target.value})},onRowSelect:function(e){this.props.onRowSelect(e)},changeSortOrder:function(e){var t=e;this.state.sortOrder===e&&(t+="r"),this.setState({sortOrder:t})},render:function(){for(var n,a,m=this,t=this.props.infos.sort(function(e,t){switch(m.state.sortOrder){case"1":return e.fields[0].localeCompare(t.fields[0]);case"1r":return-e.fields[0].localeCompare(t.fields[0]);case"2":return e.fields[1].localeCompare(t.fields[1]);case"2r":return-e.fields[1].localeCompare(t.fields[1]);case"a":return moment(e.creationDate).isBefore(t.creationDate)?1:-1;case"ar":return moment(e.creationDate).isBefore(t.creationDate)?-1:1}}),i=0,p=[],o=0;o<t.length;++o)n=moment().diff(moment(t[o].creationDate)),n>i&&(i=n);for(var e=0;e<t.length;++e)if(n=moment().diff(moment(t[e].creationDate)),-1!==t[e].fields[0].toLowerCase().indexOf(this.state.filterText.toLowerCase())||-1!==t[e].fields[1].toLowerCase().indexOf(this.state.filterText.toLowerCase())){var f=[];a=[t[e].fields[0],t[e].fields[1],this.props.typeNames[t[e].typeID],t[e].tags.join(", "),getShortPreciseIntervalStr(n)];for(var s=0;s<a.length;++s){var h,d=2===s?5:15;h=a[s].length>d?a[s].slice(0,d)+"...":a[s],f.push(4==s?React.createElement("td",{key:s},React.createElement("div",{style:{position:"absolute"}},h),React.createElement("div",{style:{height:"1em",background:"#E0E0E0",width:n/i*100+"%"}})):React.createElement("td",{key:s},h))}p.push(React.createElement("tr",{key:e,onClick:this.onRowSelect.bind(this,e)},f))}var l="1st",c="2nd",r="Age";switch(this.state.sortOrder){case"1":l+="↓";break;case"1r":l+="↑";break;case"2":c+="↓";break;case"2r":c+="↑";break;case"a":r+="↓";break;case"ar":r+="↑"}return React.createElement("div",{className:"InfoBrowser Component"},React.createElement("div",{className:"browseControls"},React.createElement("input",{type:"text",placeholder:"Quick filter...",value:this.state.filterText,onChange:this.onFilterChange}),React.createElement("button",{className:"button buttonGood",onClick:this.props.onNew},"New info")),React.createElement("table",null,React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",{onClick:this.changeSortOrder.bind(this,"1")},l),React.createElement("th",{onClick:this.changeSortOrder.bind(this,"2")},c),React.createElement("th",null,"Type"),React.createElement("th",null,"Tags"),React.createElement("th",{onClick:this.changeSortOrder.bind(this,"a")},r))),React.createElement("tbody",null,p)))}}),InfoEdit=React.createClass({displayName:"InfoEdit",getInitialState:function(){var e;return e="string"==typeof this.props.info?this.getNewInfo(this.props.info):JSON.parse(JSON.stringify(this.props.info)),{info:e}},componentDidMount:function(){this.refs.firstTextbox.getDOMNode().focus()},componentWillReceiveProps:function(e){"string"==typeof this.props.info&&this.setState({info:this.getNewInfo(e.info)})},getNewInfo:function(s){for(var e={typeID:s},n=[],a={},t=0;t<this.props.types[s].fieldNames.length;++t)n.push(""),a[t]=[];return e.fields=n,e.reviews=a,e.tags=[],e.creationDate=moment().format(),e},onTypeChange:function(s){var e=JSON.parse(JSON.stringify(this.state.info));e.typeID=s;var n=this.props.types[s].fieldNames.length,t=n-this.state.info.fields.length;if(t>0)for(var a=0;t>a;a++)e.fields.push("");else 0>t&&(e.fields=e.fields.slice(0,n));this.setState({info:e})},onFieldEdit:function(t,s){var e=JSON.parse(JSON.stringify(this.state.info));e.fields[t]=s.target.value,this.setState({info:e})},onTagsEdit:function(e){var t=JSON.parse(JSON.stringify(this.state.info));t.tags=""===e.target.value?[]:e.target.value.replace(/ /g,"").split(","),this.setState({info:t})},onSave:function(){this.props.onSave(this.state.info)},addUsedTag:function(t){var e=JSON.parse(JSON.stringify(this.state.info));e.tags.push(t),this.setState({info:e})},editType:function(){this.props.editType(this.state.info.typeID)},render:function(){for(var n=[],e=0;e<this.state.info.fields.length;++e){var o=this.props.types[this.state.info.typeID].fieldNames[e],a=!1;0===e&&(a="firstTextbox"),n.push(React.createElement("section",{key:e},React.createElement("h3",null,"Entry: ",o),React.createElement("textarea",{className:"sectionContent",ref:a,value:this.state.info.fields[e],onChange:this.onFieldEdit.bind(this,e),rows:(this.state.info.fields[e].match(/\n/g)||[]).length+1})))}for(var i,s=[],t=0;t<this.props.usedTags.length;++t)-1===this.state.info.tags.indexOf(this.props.usedTags[t])&&(i=0===s.length?"":", ",s.push(React.createElement("a",{key:t,onClick:this.addUsedTag.bind(this,this.props.usedTags[t]),href:"#"},i+this.props.usedTags[t])));var r=JSON.stringify(this.props.info)===JSON.stringify(this.state.info);return React.createElement("div",{className:"InfoEdit Component"},React.createElement("div",{className:"sectionContainer"},React.createElement(ITypeSwitcher,{typeNames:this.props.typeNames,selectedTypeID:this.state.info.typeID,onTypeChange:this.onTypeChange,editType:this.editType}),n,React.createElement("section",null,React.createElement("h3",null,"Tags"),React.createElement("textarea",{className:"sectionContent",rows:1,type:"text",value:this.state.info.tags.join(", "),onChange:this.onTagsEdit}),React.createElement("div",{className:"sectionContent"},"used: ",s))),React.createElement("div",{className:"flexContHoriz"},React.createElement("span",{className:"button buttonGood "+(r?"disabled":""),onClick:this.onSave},this.props.saveButtonStr),React.createElement("span",{className:"button",onClick:this.props.cancelEdit},"Cancel"),React.createElement("span",{className:this.props.onDelete?" button buttonDanger":"invisible",onClick:this.props.onDelete},"Delete")))}}),ITypeSwitcher=React.createClass({displayName:"ITypeSwitcher",onTypeChange:function(e){this.props.onTypeChange(e)},render:function(){var t=[];for(var e in this.props.typeNames){var s=!1;this.props.editType&&(s=React.createElement("button",{className:"button"+(this.props.selectedTypeID===e?"":" invisible"),key:"new",onClick:this.props.editType},"Edit")),t.push(React.createElement("div",{key:e,style:{margin:"1px"},className:"CombiButton"},React.createElement("button",{className:"button"+(this.props.selectedTypeID===e?" buttonGood":""),onClick:this.onTypeChange.bind(this,e)},this.props.typeNames[e]),s))}return this.props.onAddType&&t.push(React.createElement("button",{className:"button",key:"new",onClick:this.props.onAddType},"New..")),React.createElement("section",null,React.createElement("h3",null,"Info type"),React.createElement("div",{className:"sectionContent wrap"},t))}}),InfoTypes=React.createClass({displayName:"InfoTypes",getInitialState:function(){for(var e=0;!(e in this.props.infoTypes);)e++;return this.props.selectedTypeID&&(e=this.props.selectedTypeID),{selectedTypeID:e.toString(),newInfoTypes:this.props.infoTypes,changes:{renames:"",typeResizes:[]},mode:"main"}},onFieldNameEdit:function(s,n){var e=JSON.parse(JSON.stringify(this.state.newInfoTypes));e[this.state.selectedTypeID].fieldNames[s]=n.target.value;var t=JSON.parse(JSON.stringify(this.state.changes));t.renames="renamed",this.setState({newInfoTypes:e,changes:t})},selectType:function(e){this.setState({selectedTypeID:e,mode:"main"})},onNameEdit:function(s){var e=JSON.parse(JSON.stringify(this.state.newInfoTypes));e[this.state.selectedTypeID].name=s.target.value;var t=JSON.parse(JSON.stringify(this.state.changes));t.renames="renamed",this.setState({newInfoTypes:e,changes:t})},onFieldsResize:function(e){var t=JSON.parse(JSON.stringify(this.state.newInfoTypes));-1===e?t[this.state.selectedTypeID].fieldNames.push(""):t[this.state.selectedTypeID].fieldNames.splice(e,1);var s=JSON.parse(JSON.stringify(this.state.changes));s.typeResizes.push({id:this.state.selectedTypeID,fieldNameIndex:e}),this.setState({newInfoTypes:t,changes:s})},onSave:function(){this.props.onSave(this.state.newInfoTypes,this.state.changes)},componentDidUpdate:function(){"new info type"===this.state.newInfoTypes[this.state.selectedTypeID].name&&this.refs.nameRef.getDOMNode().focus()},onAddType:function(){var t=JSON.parse(JSON.stringify(this.state.newInfoTypes)),e="0";for(var s in t)parseInt(s,10)>parseInt(e,10)&&(e=s);e=(parseInt(e,10)+1).toString(),t[e]={name:"new info type",fieldNames:["first field","second field"],views:{0:{front:"{front}",back:"{back}",condition:""},1:{front:"{back}",back:"{front}",condition:"tag: reverse"}}},this.setState({newInfoTypes:t,selectedTypeID:e})},setMode:function(e){this.setState({mode:e})},onViewChange:function(t,s){var e=JSON.parse(JSON.stringify(this.state.newInfoTypes));e[this.state.selectedTypeID].views[this.state.mode][t]=s,this.setState({newInfoTypes:e})},render:function(){for(var a=[],e=this.state.newInfoTypes[this.state.selectedTypeID],t=0;t<e.fieldNames.length;++t)a.push(React.createElement("div",{key:t,className:"sectionContent"},React.createElement("input",{className:"sectionContentEl",value:e.fieldNames[t],onChange:this.onFieldNameEdit.bind(this,t)}),React.createElement("span",{className:"button buttonDanger sectionContentElFixed"+(e.fieldNames.length<=2?" invisible":""),onClick:this.onFieldsResize.bind(this,t)},"✖")));var s=[];"main"!==this.state.mode?s=React.createElement(Views,{view:e.views[this.state.mode],onViewChange:this.onViewChange}):(s.push(React.createElement("section",{key:0},React.createElement("h3",null,"Name"),React.createElement("input",{className:"sectionContent",type:"text",ref:"nameRef",id:"typeName",value:e.name,onChange:this.onNameEdit}))),s.push(React.createElement("section",{key:1},React.createElement("h3",null,"Entries ",React.createElement("span",{className:"button buttonPlain",onClick:this.onFieldsResize.bind(this,-1)},"+")),a)));var i={};for(var o in this.state.newInfoTypes)i[o]=this.state.newInfoTypes[o].name;var r=[];for(var n in e.views)r.push(React.createElement("button",{key:n,className:"flexElemContHoriz button "+(this.state.mode===n?"buttonGood":""),onClick:this.setMode.bind(this,n)},"View "+n));var c=JSON.stringify(this.props.infoTypes)===JSON.stringify(this.state.newInfoTypes);return React.createElement("div",{className:"InfoTypes Component"},React.createElement("div",{className:"sectionContainer"},React.createElement(ITypeSwitcher,{typeNames:i,selectedTypeID:this.state.selectedTypeID,onTypeChange:this.selectType,onAddType:this.onAddType}),React.createElement("section",{className:"sectionContent tabContainer"},React.createElement("button",{className:"button "+("main"===this.state.mode?"buttonGood":""),onClick:this.setMode.bind(this,"main")},"Main"),r),s,React.createElement("section",{className:"sectionContent flexContHoriz"},React.createElement("button",{className:"flexElemContHoriz button buttonGood "+(c?"disabled":""),onClick:this.onSave},"Save"),React.createElement("button",{className:"flexElemContHoriz button",onClick:this.props.cancelEdit},"Cancel"))))}}),Intervaller=React.createClass({displayName:"Intervaller",getInitialState:function(){console.log("construct intervalChoiceGroups");for(var n=[],t=[],a=["Minutes","Hours","Days","Weeks","Months","Relative"],e=0;e<this.props.timeIntervalChoices.length;++e)if(0!==this.props.timeIntervalChoices[e].length){t=[];for(var s=0;s<this.props.timeIntervalChoices[e].length;++s)t.push(this.props.timeIntervalChoices[e][s]);n.push({label:a[e],members:t.slice()})}return{modifyType:"change",changeType:"minutes",modifyAmount:10,activeKeyIndex:0,intervalChoiceGroups:n}},onModeChange:function(e){if(e!==this.state.modifyType){var t=this.state.activeKeyIndex;"set"===e&&"relative"===this.state.changeType&&(t=0),this.setState({modifyType:e,activeKeyIndex:t})}},getNewInterval:function(){var e;return"change"===this.state.modifyType?"relative"===this.state.changeType?(e=this.props.reviewInterval*this.state.modifyAmount/100,e+this.props.reviewInterval):(e=moment.duration(this.state.modifyAmount,this.state.changeType.toLowerCase()).asMilliseconds(),this.props.reviewInterval+e):"set"===this.state.modifyType?moment.duration(this.state.modifyAmount,this.state.changeType.toLowerCase()).asMilliseconds():void 0},onIntervalChoice:function(t,e,s){this.state.activeKeyIndex===e&&this.props.applyInterval(this.getNewInterval()),this.setState({activeKeyIndex:e,changeType:s,modifyAmount:t})},render:function(){for(var c,n,i=[],s=0,e=0;e<this.state.intervalChoiceGroups.length;++e){c=[];for(var t=0;t<this.state.intervalChoiceGroups[e].members.length;++t){var a="button unselectable";a+=" interval"+e%2,a+=s===this.state.activeKeyIndex?" buttonSelected":"";var l=React.createElement("span",{className:"change"===this.state.modifyType?"":"invisible"},"+");n=this.state.intervalChoiceGroups[e].members[t];var o=n;o+="Relative"===this.state.intervalChoiceGroups[e].label?"%":this.state.intervalChoiceGroups[e].label.slice(0,1).toLowerCase();var r=!1;0===t&&(r=React.createElement("div",null,this.state.intervalChoiceGroups[e].label));var h="Relative"===this.state.intervalChoiceGroups[e].label&&"set"===this.state.modifyType;i.push(React.createElement("span",{key:s,className:h?"invisible":""},r,React.createElement("div",{className:a,onClick:this.onIntervalChoice.bind(this,n,s,this.state.intervalChoiceGroups[e].label.toLowerCase())},l," ",o))),s+=1}}return React.createElement("div",{className:this.props.show?"":"invisible"},React.createElement("div",{className:"intervalButtonCont"},React.createElement("span",null,React.createElement("div",null,"Type"),React.createElement("div",{className:"button "+("change"===this.state.modifyType?"buttonGood":""),onClick:this.onModeChange.bind(this,"change")},"change")),React.createElement("span",{className:"button "+("set"===this.state.modifyType?"buttonGood":""),onClick:this.onModeChange.bind(this,"set")},"set"),i),React.createElement("div",null,"Old interval: ",getPreciseIntervalStr(this.props.reviewInterval)),React.createElement("div",null,"New interval: ",getPreciseIntervalStr(this.getNewInterval())),React.createElement("div",null,"Due on: ",moment().add(moment.duration(this.getNewInterval())).format("dddd, YYYY-MM-DD, HH:mm")))}}),Review=React.createClass({displayName:"Review",getInitialState:function(){return{progressState:"frontSide"}},componentDidMount:function(){this.refs.flipButton.getDOMNode().focus()},componentDidUpdate:function(){"frontSide"===this.state.progressState&&this.refs.flipButton.getDOMNode().focus()},flip:function(){this.setState({progressState:"backSide"})},applyInterval:function(e){this.props.applyInterval(e),this.setState({progressState:"frontSide"})},getRenderedStr:function(t){var e=[],s=t.replace(/(\$.*?\$)/g,function(s,t){return e.push(t.slice(1,-1)),"$$"});return marked(s).replace(/\$\$/g,function(){return katex.renderToString(e.shift())})},gotoEdit:function(){this.props.gotoEdit(this.props.nextInfoIndex)},render:function(){var e=!1;return"frontSide"===this.state.progressState&&(e=React.createElement("div",{style:{textAlign:"center"}},React.createElement("button",{tabIndex:"1",ref:"flipButton",className:"button buttonGood "+("frontSide"===this.state.progressState?"":"invisible"),onClick:this.flip},"Show backside"))),React.createElement("div",{className:"Review Component"},React.createElement("div",null,React.createElement("button",{className:"button",tabIndex:"2",onClick:this.gotoEdit},"Edit Info"),React.createElement("span",null,"Due count: "+this.props.dueCount)),React.createElement("div",{id:"reviewStage"},React.createElement("div",{className:"markdowned",dangerouslySetInnerHTML:{__html:this.getRenderedStr(this.props.frontStr)}}),React.createElement("div",{className:"markdowned "+("backSide"===this.state.progressState?"":"invisible"),dangerouslySetInnerHTML:{__html:this.getRenderedStr(this.props.backStr)}})),e,React.createElement(Intervaller,{show:"backSide"===this.state.progressState,reviewInterval:this.props.reviewInterval,applyInterval:this.applyInterval,timeIntervalChoices:this.props.timeIntervalChoices}))}}),Views=React.createClass({displayName:"Views",onViewChange:function(e,t){this.props.onViewChange(e,t.target.value)},render:function(){var e=[];return e.push(React.createElement("section",{key:1},React.createElement("h3",null,"Front"),React.createElement("textarea",{className:"sectionContent",value:this.props.view.front,rows:(this.props.view.front.match(/\n/g)||[]).length+1,onChange:this.onViewChange.bind(this,"front")}))),e.push(React.createElement("section",{key:2},React.createElement("h3",null,"Back"),React.createElement("textarea",{className:"sectionContent",value:this.props.view.back,rows:(this.props.view.back.match(/\n/g)||[]).length+1,onChange:this.onViewChange.bind(this,"back")}))),e.push(React.createElement("section",{key:3},React.createElement("h3",null,"Filter"),React.createElement("input",{className:"sectionContent",value:this.props.view.condition,onChange:this.onViewChange.bind(this,"condition")}))),React.createElement("div",null,e)}}),client=new Dropbox.Client({key:"ob9346e5yc509q2"});client.authDriver(new Dropbox.AuthDriver.Popup({receiverUrl:"https://leastaction.org/ginseng/dropbox_receiver.html"}));var App=React.createClass({displayName:"App",getInitialState:function(){return{infos:init_data.infos,infoTypes:init_data.infoTypes,ginseng_settings:init_data.settings,activeMode:"status",selectedTypeID:!1,selectedInfoIndex:0,dropBoxStatus:"off",lastSaved:"never"}},clickNav:function(e){this.setState({activeMode:e})},authDB:function(){var e=this;client.authenticate(function(t){e.setState(t?{dropBoxStatus:"ERROR"}:{dropBoxStatus:"logged in!"})})},saveDB:function(){var e=this,t={infos:this.state.infos,infoTypes:this.state.infoTypes,settings:this.state.ginseng_settings};client.writeFile("ginseng_data.txt",JSON.stringify(t,null,"	"),function(t,s){t?console.log("error: "+t):(console.log("file saved with revision "+s.versionTag),e.setState({lastSaved:moment().format("LTS")}))})},loadDB:function(){var e=this;client.readFile("ginseng_data.txt",function(s,n){if(s)return showError(s);var t=JSON.parse(n);e.setState({infos:t.infos,infoTypes:t.infoTypes,ginseng_settings:t.settings})})},onRowSelect:function(e){this.setState({selectedInfoIndex:e,activeMode:"edit"})},gotoEdit:function(e){this.setState({selectedInfoIndex:e,activeMode:"edit"})},onInfoEdit:function(t){var e=this.state.infos.slice();e[this.state.selectedInfoIndex]=t,this.setState({infos:e,activeMode:"browse"})},onInfoDelete:function(){var e=JSON.parse(JSON.stringify(this.state.infos));console.log("ondelete, this.state.selectedInfoIndex: "+this.state.selectedInfoIndex),e.splice(this.state.selectedInfoIndex,1),this.setState({infos:e,activeMode:"browse"})},addInfo:function(t){var s=JSON.parse(JSON.stringify(t)),e=JSON.parse(JSON.stringify(this.state.infos));e.push(s),this.setState({infos:e,activeMode:"new"})},onTypesEdit:function(i,n){for(var o=JSON.parse(JSON.stringify(i)),e=JSON.parse(JSON.stringify(this.state.infos)),t=0;t<e.length;++t)for(var s=0;s<n.typeResizes.length;++s)if(e[t].typeID===n.typeResizes[s].id){var a=n.typeResizes[s].fieldNameIndex;-1===a?e[t].fields.push(""):e[t].fields.splice(a,1)}this.setState({infoTypes:o,infos:e,activeMode:"browse"})},applyInterval:function(t,s,n){var e=JSON.parse(JSON.stringify(this.state.infos));e[t].reviews[s].push({reviewTime:moment().format(),dueTime:moment().add(moment.duration(n)).format()}),this.setState({infos:e})},filterInfo:function(s,n){if(""===s)return!0;for(var a=s.replace(/ /g,""),t=a.split(","),e=0;e<t.length;++e)if(""===t[e])console.log("   empty?");else if("tag:reverse"===t[e]){if(-1===n.tags.indexOf("reverse"))return!1}else console.log("other filter, eek");return!0},editType:function(e){this.setState({activeMode:"types",selectedTypeID:e})},render:function(){for(var a=[],t=0;t<this.state.infos.length;++t)for(var s=0;s<this.state.infos[t].tags.length;++s)-1===a.indexOf(this.state.infos[t].tags[s])&&a.push(this.state.infos[t].tags[s]);var r={};for(var p in this.state.infoTypes)r[p]=this.state.infoTypes[p].name;var l=React.createElement("div",null);if(-1!==["new","edit"].indexOf(this.state.activeMode)){var o,n,c,i;"new"==this.state.activeMode?(o=this.state.infos[this.state.infos.length-1].typeID,n=this.addInfo,c=!1,i="add"):(o=this.state.infos[this.state.selectedInfoIndex],n=this.onInfoEdit,c=this.onInfoDelete,i="save"),l=React.createElement(InfoEdit,{typeNames:r,types:this.state.infoTypes,info:o,saveButtonStr:i,usedTags:a,onSave:n,cancelEdit:this.clickNav.bind(this,"browse"),onDelete:c,editType:this.editType})}var h=React.createElement("div",null);"browse"===this.state.activeMode&&(h=React.createElement(InfoBrowser,{infos:this.state.infos,typeNames:r,onRowSelect:this.onRowSelect,onNew:this.clickNav.bind(this,"new"),selections:this.state.ginseng_selections}));var d=React.createElement("div",null);if("review"===this.state.activeMode){var e=this;!function(){var i,t,r,n=[],v=e.state.infos;for(i=0;i<v.length;++i){t=v[i];for(var s in t.reviews)if(e.filterInfo(e.state.infoTypes[t.typeID].views[s].condition,t))if(t.reviews[s].length>0){var y=t.reviews[s][t.reviews[s].length-1].dueTime,u=t.reviews[s][t.reviews[s].length-1].reviewTime,g=moment(y).diff(moment(u)),h=moment().diff(moment(u));r=h/g,r>=1?(console.log("in due urgency: "+t.fields[0].slice(0,10)+", reviewKey: "+s+", urgency: "+r),n.push([h,i,s,r])):console.log("out due urgency: "+t.fields[0].slice(0,10)+", reviewKey: "+s+", urgency: "+r)}else n.push([0,i,s,1.1]),console.log("in because new: "+t.fields[0].slice(0,10)+", reviewKey: "+s);else console.log("out due filter: "+t.fields[0].slice(0,10)+", reviewKey: "+s)}var p=n.length;if(p>0){for(var f=0,m=0,o=0,l=0,a=0;a<n.length;++a)n[a][3]>=m&&(f=n[a][0],o=n[a][1],l=n[a][2],m=n[a][3]);var c=e.state.infos[o].typeID;d=React.createElement(Review,{applyInterval:e.applyInterval.bind(e,o,l),frontStr:e.state.infoTypes[c].views[l].front.replace(/{(\w*)}/g,function(s,t){return e.state.infos[o].fields[e.state.infoTypes[c].fieldNames.indexOf(t)]}),backStr:e.state.infoTypes[c].views[l].back.replace(/{(\w*)}/g,function(s,t){return e.state.infos[o].fields[e.state.infoTypes[c].fieldNames.indexOf(t)]}),dueCount:p,reviewInterval:f,timeIntervalChoices:e.state.ginseng_settings.timeIntervalChoices,nextInfoIndex:o,gotoEdit:e.gotoEdit})}}()}var f=!1;return"types"==this.state.activeMode&&(f=React.createElement(InfoTypes,{infoTypes:this.state.infoTypes,cancelEdit:this.clickNav.bind(this,"browse"),onSave:this.onTypesEdit,selectedTypeID:this.state.selectedTypeID})),React.createElement("div",{className:"app"},React.createElement("div",{className:"navBar unselectable"},React.createElement("div",{className:"status"==this.state.activeMode?"active":"inactive",onClick:this.clickNav.bind(this,"status")},"Status"),React.createElement("div",{className:"browse"===this.state.activeMode?"active":"inactive",onClick:this.clickNav.bind(this,"browse")},"Infos"),React.createElement("div",{className:"types"==this.state.activeMode?"active":"inactive",onClick:this.clickNav.bind(this,"types")},"Types"),React.createElement("div",{className:"review"==this.state.activeMode?"active":"inactive",onClick:this.clickNav.bind(this,"review")},"Review")),React.createElement(Status,{show:"status"==this.state.activeMode,infoCount:this.state.infos.length,dropBoxStatus:this.state.dropBoxStatus,onDBAuth:this.authDB,onDbSave:this.saveDB,lastSaved:this.state.lastSaved,onDbLoad:this.loadDB}),l,h,f,d)}}),Status=React.createClass({displayName:"Status",render:function(){return this.props.show?React.createElement("div",{className:"Status Component"},React.createElement("div",null,"Infos loaded: ",this.props.infoCount),React.createElement("div",null,"Dropbox Status: ",this.props.dropBoxStatus),React.createElement("div",null,"Last save: ",this.props.lastSaved," (local time)"),React.createElement("div",null),React.createElement("div",{className:"flexContHoriz"},React.createElement("button",{className:"button buttonGood "+("logged in!"===this.props.dropBoxStatus?"disabled":""),onClick:this.props.onDBAuth},"auth Dropbox"),React.createElement("button",{className:"button "+("logged in!"===this.props.dropBoxStatus?"":"invisible"),onClick:this.props.onDbLoad},"load from Dropbox"),React.createElement("button",{className:"button "+("logged in!"===this.props.dropBoxStatus?"":"invisible"),onClick:this.props.onDbSave},"save to Dropbox"))):React.createElement("div",{className:"Status Component"})}});React.render(React.createElement(App,null),document.getElementById("content"));